# MCP Server for Kubernetes Support Bundles

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](LICENSE)
[![Python Version](https://img.shields.io/badge/python-3.11%2B-blue)](https://www.python.org/downloads/)

A Model Context Protocol (MCP) server for AI models to interact with Kubernetes support bundles. This server enables AI models to analyze and troubleshoot Kubernetes clusters by exploring support bundles generated by the [Troubleshoot](https://troubleshoot.sh/) tool.

## Features

- ğŸš€ **Bundle Management**: Initialize and manage Kubernetes support bundles
- ğŸ® **Command Execution**: Run kubectl commands against bundle's API server
- ğŸ“ **File Explorer**: Navigate and search files within the bundle
- ğŸ” **Secure Authentication**: Token-based authentication for bundle access
- ğŸ³ **Docker Support**: Run as a containerized application

## Quick Start

### Using Docker

The easiest way to get started is using Docker:

```bash
# Build the image
./build.sh

# Run the server
./run.sh /path/to/bundles your-token
```

See the [Docker documentation](DOCKER.md) for more details.

### Manual Installation

1. Ensure you have Python 3.11+ installed
2. Install the package:

```bash
# Using uv (recommended)
uv pip install -e .

# Or using pip
pip install -e .
```

3. Set up your authentication token:

```bash
export SBCTL_TOKEN=your-token
```

4. Run the server:

```bash
python -m mcp_server_troubleshoot
```

## Documentation

For comprehensive documentation, see:

- [User Guide](docs/user_guide.md): Installation, configuration, and usage
- [API Reference](docs/api_reference.md): Detailed API documentation
- [Developer Guide](docs/developer_guide.md): Information for developers
- [Example Prompts](docs/examples/prompt_examples.md): Sample AI prompts and responses
- [Troubleshooting Guide](docs/troubleshooting.md): Solutions for common issues
- [Docker Guide](DOCKER.md): Container usage and configuration
- [System Architecture](docs/architecture.md): Overall system design

## Tools

The MCP server provides the following tools for AI models:

### Bundle Management

- `bundle__list`: List available support bundles
- `bundle__initialize`: Initialize a support bundle for use
- `bundle__info`: Get information about the current bundle

### Kubectl Commands

- `kubectl__execute`: Execute kubectl commands against the bundle

### File Operations

- `files__list_directory`: List files and directories
- `files__read_file`: Read file contents
- `files__search_files`: Search for patterns in files

## Example Usage

AI models can interact with the server using the MCP protocol:

```json
// Request to list directories
{
  "name": "files__list_directory",
  "input": {
    "path": "/kubernetes/pods"
  }
}

// Response
{
  "content": [
    {
      "name": "kube-system",
      "type": "directory",
      "size": null,
      "modified": "2025-04-10T12:30:45Z"
    },
    {
      "name": "pod-definition.yaml",
      "type": "file",
      "size": 1254,
      "modified": "2025-04-10T12:30:45Z"
    }
  ]
}
```

## Project Structure

```
mcp-server-troubleshoot/
â”œâ”€â”€ docs/                 # Documentation
â”‚   â”œâ”€â”€ architecture.md   # System architecture overview
â”‚   â”œâ”€â”€ api_reference.md  # API reference documentation
â”‚   â”œâ”€â”€ user_guide.md     # User guide
â”‚   â”œâ”€â”€ developer_guide.md # Developer guide
â”‚   â”œâ”€â”€ troubleshooting.md # Troubleshooting guide
â”‚   â”œâ”€â”€ examples/         # Example prompts and usage
â”‚   â”œâ”€â”€ agentic/          # AI agent documentation
â”‚   â””â”€â”€ components/       # Component design docs
â”œâ”€â”€ tasks/                # Task definitions
â”‚   â”œâ”€â”€ ready/            # Tasks ready to be worked on
â”‚   â”œâ”€â”€ started/          # Tasks currently in progress
â”‚   â”œâ”€â”€ review/           # Tasks pending review
â”‚   â””â”€â”€ completed/        # Tasks that have been completed
â”œâ”€â”€ src/                  # Source code
â”œâ”€â”€ tests/                # Test files
â””â”€â”€ README.md             # This file
```

## Requirements

- Python 3.11 or later
- `kubectl` command-line tool
- `sbctl` command-line tool for bundle management
- Token for authentication (set as `SBCTL_TOKEN` environment variable)

## Contributing

Contributions are welcome! Please see the [Developer Guide](docs/developer_guide.md) for details on how to contribute.

## License

This project is licensed under the Apache License 2.0 - see the [LICENSE](LICENSE) file for details.